import java.io.File;
import java.util.ArrayList;
import java.util.HashMap;

import jxl.Workbook;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;

public class Reader {

	public static WritableWorkbook wb;
	private static WritableSheet sheet, sheet2;
	private static int index, dosIndex;
	public static HashMap<String, ArrayList<String>> map, dosMap;
	public static ArrayList<String> vList, dosList;

	public static void run() throws Exception {

		makechart();
		index = 1;
		map = new HashMap<String, ArrayList<String>>();
		dosMap = new HashMap<String, ArrayList<String>>();
		vList = new ArrayList<String>();
		dosList = new ArrayList<String>();
	}

	public static void addVersion(String v, ArrayList<String> data, int x)
			throws Exception {

		String[] line;

		ArrayList<String> list = new ArrayList<String>();
		ArrayList<String> list2 = new ArrayList<String>();

		for (String s : data) {
			
			line = s.split("\t");
			
			sheet.addCell(new Label(0, index, v));
			sheet.addCell(new Label(1, index, line[1]));
			sheet.addCell(new Label(2, index, line[7]));
			
			String os = "";
			
			if (line[15].contains("Windows"))
				os += ", Windows";
			if (line[15].contains("BSD"))
				os += ", BSD";
			if (line[15].contains("Android"))
				os += ", Android";
			if (line[15].contains("Mac OS"))
				os += ", Mac OS X";
			if (line[15].contains("Solaris"))
				os += ", Solaris";
			if (line[15].contains("Linux"))
				os += ", Linux";
			
			if (os.length() == 0)
				os = "All";
			else
				os = os.substring(2);
			
			sheet.addCell(new Label(3, index, os));
			
			list.add(line[1]);

			index++;
			
			if (line[4].contains("DoS"))
				continue;
			
			sheet2.addCell(new Label(0, dosIndex, v));
			sheet2.addCell(new Label(1, dosIndex, line[1]));
			sheet2.addCell(new Label(2, dosIndex, line[7]));
			sheet2.addCell(new Label(3, dosIndex, os));

			list2.add(line[1]);

			dosIndex++;
			
		}

		map.put(v, list);
		vList.add(v);
		
		dosMap.put(v, list2);
		dosList.add(v);

	}

	public static void close() throws Exception {

		wb.write();
		wb.close();

	}

	private static void makechart() throws Exception {

		wb = Workbook.createWorkbook(new File("file.xls"));
		sheet = wb.createSheet("List", 0);
		sheet.addCell(new Label(0, 0, "Version"));
		sheet.addCell(new Label(1, 0, "CVE"));
		sheet.addCell(new Label(2, 0, "Score"));
		sheet.addCell(new Label(3, 0, "OS"));
		
		sheet2 = wb.createSheet("DOS Removed List", 1);
		sheet2.addCell(new Label(0, 0, "Version"));
		sheet2.addCell(new Label(1, 0, "CVE"));
		sheet2.addCell(new Label(2, 0, "Score"));
		sheet2.addCell(new Label(3, 0, "OS"));

	}

}
