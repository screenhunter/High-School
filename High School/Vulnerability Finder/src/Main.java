import java.util.ArrayList;

public class Main {

	private static String pages[] = {

	"http://www.cvedetails.com/version-list/45/66/1/Apache-Http-Server.html",
	"http://www.cvedetails.com/version-list/45/66/2/Apache-Http-Server.html",
	"http://www.cvedetails.com/version-list/45/66/3/Apache-Http-Server.html",
	"http://www.cvedetails.com/version-list/45/66/4/Apache-Http-Server.html",
	"http://www.cvedetails.com/version-list/45/66/5/Apache-Http-Server.html"

	};

	private static ArrayList<String> list;

	public static void main(String[] args) throws Exception {

		Reader.run();

		String[] line;
		for (String s : pages) {

			list = PageFinder.main(s);
			list.remove(0);

			for (String x : list) {

				line = x.split("\t");

//				System.out.println("RK is superb ->" + line[5]);
//				System.out.println("RK 1->" + line[5].indexOf("href=\"") + 6);
//				System.out.println("RK 2->" + line[5].indexOf(".html"));

				String path = "http://www.cvedetails.com"
						+ line[5].substring(line[5].indexOf("href=\"") + 6,
								line[5].indexOf(".html") + 5).replaceAll(" ",
								"");

				//System.out.println("WGKK WGJKF " + path);
				ArrayList<String> vuln = VulnerabilityLister.main(path);

				Reader.addVersion(line[0], vuln, Integer.parseInt(line[4]));

			}

		}
		
		Analyzer.create();
		Analyzer.createDos();
		Reader.close();

	}

}
